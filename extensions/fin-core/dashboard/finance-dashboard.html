<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>OpenFinclaw Finance Dashboard</title>
    <style>
      /*__FINANCE_CSS__*/
    </style>
  </head>
  <body>
    <main class="layout">
      <header class="hero">
        <p class="eyebrow">OpenFinclaw Control</p>
        <h1>Finance Dashboard</h1>
        <p class="sub">Exchange wiring, trading limits, and finance plugin status at a glance.</p>
      </header>

      <section class="panel" id="summary"></section>
      <section class="panel" id="trading"></section>
      <section class="panel" id="exchanges"></section>
      <section class="panel" id="plugins"></section>
    </main>

    <script>
      const financeData = /*__FINANCE_DATA__*/ {};

      function money(value) {
        return "$" + Number(value || 0).toLocaleString();
      }

      function renderSummary() {
        const root = document.getElementById("summary");
        root.innerHTML = `
          <h2>Summary</h2>
          <div class="metrics">
            <article><span>Exchanges</span><strong>${financeData.exchanges.length}</strong></article>
            <article><span>Plugins Enabled</span><strong>${financeData.plugins.enabled}/${financeData.plugins.total}</strong></article>
            <article><span>Trading</span><strong>${financeData.trading.enabled ? "Enabled" : "Disabled"}</strong></article>
            <article><span>Updated</span><strong>${new Date(financeData.generatedAt).toLocaleString()}</strong></article>
          </div>
        `;
      }

      function renderTrading() {
        const root = document.getElementById("trading");
        const trading = financeData.trading;
        root.innerHTML = `
          <h2>Trading Risk Limits</h2>
          <ul class="kv">
            <li><span>Auto trade limit</span><strong>${money(trading.maxAutoTradeUsd)}</strong></li>
            <li><span>Confirm threshold</span><strong>${money(trading.confirmThresholdUsd)}</strong></li>
            <li><span>Daily loss limit</span><strong>${money(trading.maxDailyLossUsd)}</strong></li>
            <li><span>Max position</span><strong>${trading.maxPositionPct}%</strong></li>
            <li><span>Max leverage</span><strong>${trading.maxLeverage}x</strong></li>
          </ul>
        `;
      }

      function renderExchanges() {
        const root = document.getElementById("exchanges");
        if (financeData.exchanges.length === 0) {
          root.innerHTML = "<h2>Exchanges</h2><p class='empty'>No exchanges configured.</p>";
          return;
        }

        const rows = financeData.exchanges
          .map(
            (entry) => `
              <tr>
                <td>${entry.id}</td>
                <td>${entry.exchange}</td>
                <td>${entry.testnet ? "yes" : "no"}</td>
              </tr>
            `,
          )
          .join("");

        root.innerHTML = `
          <h2>Exchanges</h2>
          <table>
            <thead>
              <tr><th>Name</th><th>Type</th><th>Testnet</th></tr>
            </thead>
            <tbody>${rows}</tbody>
          </table>
        `;
      }

      function renderPlugins() {
        const root = document.getElementById("plugins");
        const rows = financeData.plugins.entries
          .map(
            (entry) => `
              <li class="${entry.enabled ? "ok" : "off"}">
                <span>${entry.id}</span>
                <strong>${entry.enabled ? "enabled" : "disabled"}</strong>
              </li>
            `,
          )
          .join("");

        root.innerHTML = `
          <h2>Finance Plugin Matrix</h2>
          <ul class="plugin-list">${rows}</ul>
        `;
      }

      renderSummary();
      renderTrading();
      renderExchanges();
      renderPlugins();
    </script>
  </body>
</html>
